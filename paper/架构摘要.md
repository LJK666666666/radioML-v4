# è½»é‡çº§æ··åˆResNet-ComplexCNNæ¶æ„æ‘˜è¦

## ğŸ¯ æ ¸å¿ƒæ€æƒ³
åœ¨å¤æ•°åŸŸä¸­è¿›è¡Œç«¯åˆ°ç«¯æ— çº¿ç”µä¿¡å·è°ƒåˆ¶è¯†åˆ«ï¼Œé€šè¿‡æ®‹å·®è¿æ¥ä¿æŒæ¢¯åº¦æµï¼ŒåŒæ—¶ä¿ç•™ä¿¡å·çš„å¹…åº¦å’Œç›¸ä½ä¿¡æ¯ã€‚

## ğŸ—ï¸ æ¶æ„æ¦‚è§ˆ

```
è¾“å…¥(2Ã—128) â†’ é‡æ’åˆ— â†’ å¤æ•°ç‰¹å¾æå– â†’ å¤æ•°æ®‹å·®å¤„ç† â†’ å…¨å±€æ± åŒ– â†’ å¤æ•°å…¨è¿æ¥ â†’ åˆ†ç±»è¾“å‡º
     â†“            â†“            â†“             â†“           â†“          â†“           â†“
   I/Qä¿¡å·    (128Ã—2)      32æ»¤æ³¢å™¨       64â†’128â†’256    å…¨å±€å¹³å‡   512ç»´å¤æ•°     11ç±»
```

## ğŸ“Š å…³é”®æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | æ•°å€¼ |
|------|------|
| **å‡†ç¡®ç‡** | 65.4% (GPRå¢å¼º) |
| **å‚æ•°é‡** | ~1.3M |
| **è®­ç»ƒæ—¶é—´** | 55åˆ†é’Ÿ |
| **æ¨ç†æ—¶é—´** | 2.5ms |
| **å†…å­˜å ç”¨** | 155MB |

## ğŸ”§ æŠ€æœ¯åˆ›æ–°

### 1. å¤æ•°æ®‹å·®å—
```python
F_complex(z) = H_complex(z) + z
# å…¶ä¸­ z = x + jy (å¤æ•°è¾“å…¥)
# H_complex: å¤æ•°æ˜ å°„å‡½æ•°
```

### 2. å¤æ•°å·ç§¯è¿ç®—
```python
# å¤æ•°ä¹˜æ³•: (a+bi)(c+di) = (ac-bd) + (ad+bc)i
output_real = conv(real, kernel_real) - conv(imag, kernel_imag)
output_imag = conv(real, kernel_imag) + conv(imag, kernel_real)
```

### 3. å¤æ•°æ‰¹å½’ä¸€åŒ–
```python
# åˆ†åˆ«å½’ä¸€åŒ–å®éƒ¨å’Œè™šéƒ¨
real_norm = (real - Î¼_r) / Ïƒ_r
imag_norm = (imag - Î¼_i) / Ïƒ_i
```

## ğŸ¨ æ¶æ„è¯¦ç»†è®¾è®¡

### é˜¶æ®µ1: è¾“å…¥é¢„å¤„ç†
- **è¾“å…¥**: (batch, 2, 128) - I/Qä¸¤é€šé“
- **è¾“å‡º**: (batch, 128, 2) - æ—¶é—´åºåˆ—æ ¼å¼
- **æ“ä½œ**: Permuteç»´åº¦é‡æ’

### é˜¶æ®µ2: åˆå§‹ç‰¹å¾æå–
- **å±‚**: ComplexConv1D(32, k=5) + ComplexBN + ComplexReLU + Pool
- **è¾“å‡º**: (batch, 64, 32)
- **ä½œç”¨**: æ•è·æ—¶é—´ç›¸å…³æ€§

### é˜¶æ®µ3: å¤æ•°æ®‹å·®å¤„ç†
- **åŸºç¡€æ®‹å·®å—**: ComplexResidualBlock(64)
- **ä¸‹é‡‡æ ·æ®‹å·®å—**: ComplexResidualBlock(128, stride=2)  
- **é«˜çº§æ®‹å·®å—**: ComplexResidualBlockAdvanced(256, stride=2)
- **è¾“å‡º**: (batch, 16, 256)

### é˜¶æ®µ4: å…¨å±€ç‰¹å¾èšåˆ
- **å±‚**: ComplexGlobalAveragePooling1D
- **è¾“å‡º**: (batch, 256) - å¤æ•°å‘é‡
- **ä½œç”¨**: æ•´åˆå…¨å±€ä¿¡æ¯

### é˜¶æ®µ5: å¤æ•°å…¨è¿æ¥
- **å±‚**: ComplexDense(512) + ComplexReLU + Dropout(0.5)
- **è¾“å‡º**: (batch, 512) - å¤æ•°å‘é‡
- **ä½œç”¨**: é«˜çº§ç‰¹å¾å­¦ä¹ 

### é˜¶æ®µ6: åˆ†ç±»è¾“å‡º
- **å±‚**: ComplexMagnitude + Dense(11) + Softmax
- **è¾“å‡º**: (batch, 11) - ç±»åˆ«æ¦‚ç‡
- **ä½œç”¨**: å¤æ•°è½¬å®æ•°å¹¶åˆ†ç±»

## ğŸ“ˆ æ€§èƒ½å¯¹æ¯”

### vs ä¼ ç»Ÿæ–¹æ³•
| æ¨¡å‹ | å‡†ç¡®ç‡ | å‚æ•°é‡ | ä¼˜åŠ¿ |
|------|--------|--------|------|
| CNNåŸºçº¿ | 58.3% | 0.8M | ç®€å• |
| ResNet-18 | 61.7% | 2.1M | æ®‹å·®è¿æ¥ |
| ComplexCNN | 63.2% | 1.5M | å¤æ•°å¤„ç† |
| **æœ¬æ¶æ„** | **65.4%** | **1.3M** | **å¤æ•°+æ®‹å·®** |

### ä¸åŒSNRä¸‹æ€§èƒ½
- **ä½SNR (-20dB)**: 28.3%
- **ä¸­SNR (0dB)**: 72.1%  
- **é«˜SNR (20dB)**: 98.1%

## ğŸ› ï¸ å®ç°è¦ç‚¹

### å¤æ•°å±‚æ ¸å¿ƒä»£ç 
```python
class ComplexConv1D(Layer):
    def call(self, inputs):
        real = inputs[..., 0::2]  # å®éƒ¨
        imag = inputs[..., 1::2]  # è™šéƒ¨
        
        # å¤æ•°å·ç§¯è®¡ç®—
        conv_rr = tf.nn.conv1d(real, self.kernel_real, ...)
        conv_ri = tf.nn.conv1d(real, self.kernel_imag, ...)
        conv_ir = tf.nn.conv1d(imag, self.kernel_real, ...)
        conv_ii = tf.nn.conv1d(imag, self.kernel_imag, ...)
        
        output_real = conv_rr - conv_ii
        output_imag = conv_ri + conv_ir
        
        return tf.stack([output_real, output_imag], axis=-1)
```

### æ¨¡å‹æ„å»º
```python
def build_lightweight_hybrid_model():
    inputs = Input(shape=(2, 128))
    x = Permute((2, 1))(inputs)
    
    # å¤æ•°ç‰¹å¾æå–
    x = ComplexConv1D(32, 5)(x)
    x = ComplexBatchNormalization()(x)
    x = ComplexActivation('complex_leaky_relu')(x)
    
    # æ®‹å·®å¤„ç†
    x = ComplexResidualBlock(64)(x)
    x = ComplexResidualBlock(128, strides=2)(x)
    x = ComplexResidualBlockAdvanced(256, strides=2)(x)
    
    # å…¨å±€æ± åŒ–å’Œåˆ†ç±»
    x = ComplexGlobalAveragePooling1D()(x)
    x = ComplexDense(512)(x)
    x = ComplexMagnitude()(x)
    outputs = Dense(11, activation='softmax')(x)
    
    return Model(inputs, outputs)
```

## ğŸš€ éƒ¨ç½²ä¼˜åŒ–

### TensorFlow Liteè½¬æ¢
```python
converter = tf.lite.TFLiteConverter.from_keras_model(model)
converter.optimizations = [tf.lite.Optimize.DEFAULT]
converter.target_spec.supported_types = [tf.float16]
tflite_model = converter.convert()
```

### æ¨ç†API
```python
@app.route('/predict', methods=['POST'])
def predict():
    iq_data = np.array(request.json['iq_samples'])
    prediction = model.predict(iq_data.reshape(1, 2, 128))
    return jsonify({
        'modulation': CLASSES[np.argmax(prediction)],
        'confidence': float(np.max(prediction))
    })
```

## ğŸ¯ é€‚ç”¨åœºæ™¯

### âœ… é€‚åˆçš„åº”ç”¨
- å®æ—¶è°ƒåˆ¶è¯†åˆ«
- èµ„æºå—é™çš„åµŒå…¥å¼è®¾å¤‡
- é¢‘è°±ç›‘æµ‹ç³»ç»Ÿ
- è®¤çŸ¥æ— çº¿ç”µ

### âš ï¸ é™åˆ¶æ¡ä»¶
- éœ€è¦å¤æ•°è¿ç®—æ”¯æŒ
- è®­ç»ƒç›¸å¯¹å¤æ‚
- æŸäº›ç¡¬ä»¶ä¼˜åŒ–ä¸è¶³

## ğŸ”® æœªæ¥æ”¹è¿›æ–¹å‘

1. **è‡ªé€‚åº”æ¶æ„**: æ ¹æ®ä¿¡å·ç‰¹æ€§åŠ¨æ€è°ƒæ•´ç½‘ç»œç»“æ„
2. **å¤šæ¨¡æ€èåˆ**: ç»“åˆæ—¶åŸŸã€é¢‘åŸŸç‰¹å¾
3. **ç¡¬ä»¶ååŒè®¾è®¡**: é’ˆå¯¹ç‰¹å®šç¡¬ä»¶ä¼˜åŒ–
4. **è”é‚¦å­¦ä¹ **: æ”¯æŒåˆ†å¸ƒå¼è®­ç»ƒå’Œæ¨ç†

---

## ğŸ“š ç›¸å…³èµ„æº

- **å®Œæ•´æ–‡æ¡£**: `æ··åˆResNet-ComplexCNNæ¶æ„.md`
- **æ¨¡å‹å®ç°**: `src/model/hybrid_complex_resnet_model.py`
- **è®­ç»ƒæƒé‡**: `model_weight_saved/lightweight_hybrid_model_gpr_augment.keras`
- **æ¶æ„æ–‡æ¡£**: `LIGHTWEIGHT_HYBRID_MODEL_ARCHITECTURE.md`
